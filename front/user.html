<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <title>Usuário</title>
    <link rel="stylesheet" href="./user-style.css">
    <link href='https://unpkg.com/boxicons@2.0.7/css/boxicons.min.css' rel='stylesheet'>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
<div class="sidebar close">
    <div class="logo-details">
        <img src="images/logo.png" alt="Logo" class="logo-img">
        <span class="logo_name">UpRef</span>
    </div>
    <ul class="nav-links">
        <li>
            <a href="#">
                <i class='bx bx-grid-alt'></i>
                <span class="link_name">Menu</span>
            </a>
            <ul class="sub-menu blank">
                <li><a class="link_name" href="#">Menu</a></li>
            </ul>
        </li>
        <li>
            <a href="#" onclick="loadSearchPage()">
                <i class='bx bx-search'></i>
                <span class="link_name">Busca</span>
            </a>
            <ul class="sub-menu blank">
                <li><a class="link_name" href="#" onclick="loadSearchPage()">Busca</a></li>
            </ul>
        </li>
        <li>
            <div class="icon-link">
                <a href="#">
                    <i class='bx bx-folder'></i>
                    <span class="link_name">Pastas</span>
                </a>
                <i class='bx bxs-chevron-down arrow'></i>
            </div>
            <ul class="sub-menu" id="folders-list">
                <!-- Dynamic content will be inserted here -->
            </ul>
            <!-- <ul class="sub-menu">
                <li><a class="link_name" href="#">Pastas</a></li>
                <li><a href="#" onclick="loadFolderPage()">Embedding</a></li>
                <li><a href="#">Machine Learning</a></li>
            </ul> -->
        </li>
        <li>
            <div class="profile-details">
                <div class="profile-content">
                    <img src="images/duckmad.png" alt="profileImg">
                </div>
                <div class="name-job">
                    <div class="profile_name">Mad Dcuky</div>
                    <div class="job">Usuário</div>
                </div>
                <i class='bx bx-log-out'></i>
            </div>
        </li>
    </ul>
</div>
<section class="home-section">
    <div class="home-content">
        <i class='bx bx-menu'></i>
        <span class="text">Bem vindo ao UpRef</span>
    </div>
    <div id="content"></div>
</section>
<script>
    let arrow = document.querySelectorAll(".arrow");
    for (var i = 0; i < arrow.length; i++) {
        arrow[i].addEventListener("click", (e) => {
            let arrowParent = e.target.parentElement.parentElement; 
            arrowParent.classList.toggle("showMenu");
        });
    }
    let sidebar = document.querySelector(".sidebar");
    let sidebarBtn = document.querySelector(".bx-menu");
    console.log(sidebarBtn);
    sidebarBtn.addEventListener("click", () => {
        sidebar.classList.toggle("close");
    });

    function loadSearchPage() {
        fetch('./search_tool/search.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('content').innerHTML = data;
                executeSearchPageScript();
            })
            .catch(error => console.error('Deu erro :(', error));
    }

    function loadFolderPage() {
        fetch('./search_result/demo.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('content').innerHTML = data;
                executeSearchPageScript();
            })
            .catch(error => console.error('Deu erro :(', error));   
    }
    function executeSearchPageScript() {
        let selection = document.querySelector(".selection");
        let selected_text = document.querySelector(".selection p");
        let categories = document.querySelector(".categories");
        let options = document.querySelectorAll(".categories p");

        selection.onclick = function() {
            categories.classList.toggle("active");
        }

        options.forEach(option => {
            option.onclick = function() {
                selected_text.innerHTML = option.innerHTML;
                categories.classList.toggle("active");
            }
        });
    }
    document.addEventListener('DOMContentLoaded', function() {
    fetch('./user_folders.json') // Fetch JSON file
        .then(response => response.json()) // Parse JSON
        .then(data => {
            const foldersList = document.getElementById('folders-list');
            data.folders.forEach(folder => {
                const li = document.createElement('li');
                const a = document.createElement('a');
                a.setAttribute('class', 'link_name');
                a.setAttribute('href', `#${folder.name}`);
                a.textContent = folder.name;
                li.appendChild(a);
                foldersList.appendChild(li);
            });
        })
        .catch(error => console.error('Error fetching JSON:', error));
});
</script>
</body>
</html>
